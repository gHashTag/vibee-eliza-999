---
name: vibe-neurophoto
agent_id: vibe-neurophoto
description: üé® Auto-activates for AI image generation, LoRA training, NeuroPhoto, and fal.ai/Replicate integration
keywords:
  - neurophoto
  - –Ω–µ–π—Ä–æ—Ñ–æ—Ç–æ
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - image generation
  - lora
  - LoRA
  - –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
  - fal.ai
  - replicate
  - fal
  - diffusion
  - flux
  - avatar
  - —Ü–∏—Ñ—Ä–æ–≤–æ–µ —Ç–µ–ª–æ
model: sonnet
trigger_threshold: 0.8
auto_activate: true
---

# üé® Vibe NeuroPhoto Skill - AI Image Generation

–≠—Ç–æ—Ç —Å–∫–∏–ª–ª **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è** –∫–æ–≥–¥–∞ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, LoRA, NeuroPhoto –∏–ª–∏ AI –º–æ–¥–µ–ª–∏.

## üöÄ –ö–æ–≥–¥–∞ –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

### –ö–ª—é—á–µ–≤—ã–µ –°–ª–æ–≤–∞ (_auto_activate: true_):
- `neurophoto`, `–Ω–µ–π—Ä–æ—Ñ–æ—Ç–æ`
- `–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`, `image generation`
- `lora`, `LoRA`, `–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏`
- `fal.ai`, `fal`, `replicate`
- `–¥–∏—Ñ—Ñ—É–∑–∏—è`, `diffusion`, `flux`
- `avatar`, `—Ü–∏—Ñ—Ä–æ–≤–æ–µ —Ç–µ–ª–æ`
- `–ø–æ—Ä—Ç—Ä–µ—Ç`, `portrait`, `cyberpunk`
- `—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ`

### –ü—Ä–∏–º–µ—Ä—ã:
```
"–°–æ–∑–¥–∞–π LoRA –º–æ–¥–µ–ª—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"
‚Üí –ê–≤—Ç–æ-–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è vibe-neurophoto

"–ù–∞—Å—Ç—Ä–æ–∏—Ç—å NeuroPhoto –≥–µ–Ω–µ—Ä–∞—Ü–∏—é"
‚Üí –ê–≤—Ç–æ-–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è vibe-neurophoto

"–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å fal.ai API"
‚Üí –ê–≤—Ç–æ-–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è vibe-neurophoto
```

## üéØ –ß—Ç–æ –î–µ–ª–∞–µ—Ç

1. **LoRA Training**: –û–±—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
2. **Image Generation**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ LoRA
3. **Service Integration**: fal.ai, Replicate API
4. **Digital Avatar**: –¶–∏—Ñ—Ä–æ–≤–æ–µ —Ç–µ–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **Prompt Engineering**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤
6. **Cost Calculation**: –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
model: sonnet              # –ú–æ—â–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
trigger_threshold: 0.8     # –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (80%)
auto_activate: true        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- **–í—ã–∑—ã–≤–∞–µ—Ç—Å—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å AI –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- **–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç—Å—è —Å**: vibe-coder, vibe-ai, vibe-services
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ì–æ—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ + –æ–±—É—á–µ–Ω–∏—è

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –Ø–≤–Ω—ã–π –≤—ã–∑–æ–≤:
```
Task(
  subagent_type="vibe-neurophoto",
  description="Create LoRA training service",
  prompt="Build service for training personal LoRA models via fal.ai"
)
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
```
"–î–æ–±–∞–≤—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ trigger word"
‚Üí vibe-neurophoto –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## üé® –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

- ‚úÖ **Fal.ai Integration**: flux-dev-lora-trainer, flux-schnell
- ‚úÖ **Replicate API**: –ú–æ–¥–µ–ª–∏ –∏ inference
- ‚úÖ **LoRA Training**: Personal model creation
- ‚úÖ **Image Generation**: With user-specific LoRA
- ‚úÖ **Prompt Engineering**: Gender + trigger word + prompt
- ‚úÖ **Cost Calculation**: Stars, tokens, pricing
- ‚úÖ **Database Schema**: user_models, operations, assets
- ‚úÖ **ElizaOS Services**: Service lifecycle + delayed initialization
- ‚úÖ **ActionResult Pattern**: success –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

## üìö –ü–∞—Ç—Ç–µ—Ä–Ω—ã

### Service Pattern (Official ElizaOS):
```typescript
export class NeuroPhotoService extends Service {
  static serviceType = 'neuro-photo';
  capabilityDescription = 'AI image generation with LoRA models';

  private falClient: FalClient;
  private replicateClient: ReplicateClient;

  constructor(private runtime: IAgentRuntime) {
    super();
  }

  async initialize(): Promise<void> {
    const falKey = this.runtime.getSetting('FAL_KEY');
    if (!falKey) {
      throw new Error('FAL_KEY not configured');
    }

    this.falClient = new FalClient({ apiKey: falKey });
  }

  async generateImage(options: GenerateImageOptions): Promise<ImageGenerationResult> {
    // Combine trigger word + gender + user prompt
    const prompt = `${options.triggerWord}, ${options.gender}, ${options.userPrompt}`;

    try {
      // Call fal.ai or Replicate
      const result = await this.falClient.generate({
        prompt,
        model_url: options.modelUrl
      });

      this.runtime.logger.info('Image generated', { userId: options.userId });

      return {
        success: true,
        imageUrl: result.url,
        metadata: result.metadata
      };

    } catch (error) {
      this.runtime.logger.error('Image generation failed', { error });
      throw error;
    }
  }

  async stop(): Promise<void> {
    await this.falClient.disconnect();
  }
}
```

### Database Schema Pattern:
```typescript
// Drizzle Schema
export const userModelsTable = pgTable('user_models', {
  id: uuid('id').primaryKey().defaultRandom(),
  telegramId: bigint('telegram_id', { mode: 'number' }).notNull(),
  modelName: varchar('model_name').notNull(),
  modelUrl: varchar('model_url').notNull(),
  triggerWord: varchar('trigger_word').notNull(),
  gender: varchar('gender').notNull(),
  status: varchar('status').notNull().default('training'),
  createdAt: timestamp('created_at').defaultNow().notNull(),
  completedAt: timestamp('completed_at'),
});

// Repository
export class UserModelsRepository {
  async findActiveByTelegramId(telegramId: number): Promise<UserModel[]> {
    const db = this.runtime.databaseAdapter.db;
    return await db.select()
      .from(userModelsTable)
      .where(and(
        eq(userModelsTable.telegramId, telegramId),
        eq(userModelsTable.status, 'completed')
      ));
  }

  async create(modelData: CreateUserModelData): Promise<UserModel> {
    const db = this.runtime.databaseAdapter.db;
    const [result] = await db.insert(userModelsTable)
      .values(modelData)
      .returning();

    return result;
  }
}
```

### LoRA Training Flow:
```
1. User uploads 10-25 photos
2. System creates ZIP archive
3. Send to fal.ai LoRA trainer
4. Save model_url to database
5. Generate trigger_word (e.g., "NEURO_SAGE")
6. Status: training ‚Üí completed
```

### Image Generation Flow:
```
1. Get user's active LoRA models
2. If none ‚Üí "Train a model first"
3. If one ‚Üí auto-select
4. If multiple ‚Üí show selection keyboard
5. Generate with: trigger_word + gender + prompt
6. Save to assets table
7. Deduct balance (4‚≠ê per image)
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∏ –º–æ—â–Ω–æ–π!** üé®üñºÔ∏è
