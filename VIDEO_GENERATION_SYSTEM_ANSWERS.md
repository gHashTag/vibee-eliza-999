# Ответы на вопросы по системе генерации видео-роликов

## 1. Опиши полный текущий pipeline генерации ролика от запроса в боте до выдачи результата.

**Ответ:** Pipeline находится в сервисе render-server. Стандартный flow: запрос в боте → очередь задач → обработка медиа (Ingest) → генерация через Veo/Hedra/HeyGen → монтаж → финальная склейка → возврат результата пользователю.

---

## 2. Какие сервисы участвуют в пайплайне и как они взаимодействуют?

**Ответ:** render-server включает: Telegram Bot API, Ingest Service, Render Service (Veo/Hedra/HeyGen), Template Engine (Adobe After Effects), Video Editor, Queue System (Redis/Bull/Inngest), Neon DB.

---

## 3. Какие части пайплайна синхронные, а какие асинхронные?

**Ответ:** Синхронные: прием запроса, валидация. Асинхронные: обработка медиа, рендер, монтаж, склейка.

---

## 4. Какие сейчас есть bottleneck'и и слабые точки?

**Ответ:**

**Финансовые проблемы:**

- Отсутствие финансирования (оплата нейросетей из личных средств, клиент не платит)
- Отсутствие финансирования разработки (разработчики без зарплаты)

**Кадровые проблемы:**

- Нехватка экспертов-видеомонтажеров для создания профессиональных шаблонов (есть один человек, нужна команда)
- Отсутствие критиков/экспертов для профессиональной оценки качества за деньги

**Технические проблемы:**

- Отсутствие собственного GPU-оборудования (необходим локальный компьютер с GPU для дешевого рендеринга видео на собственной ферме, требуется обновление оборудования)
- Лимиты API внешних сервисов (Veo/Hedra/HeyGen)
- Время рендера
- Размер очереди

---

## 5. Как работает retry при ошибках рендера?

**Ответ:** В render-server реализована система retry с экспоненциальной задержкой. Максимум попыток и стратегия настраиваются.

---

## 6. Какие есть ограничения со стороны Veo, Hedra, HeyGen и других моделей?

**Ответ:** Veo: длительность, разрешение, rate limits. Hedra: длительность клипов, качество. HeyGen: длительность, персонажи. Детали в документации render-server.

---

## 7. Как устроен текущий Ingest и на чём он написан?

**Ответ:** Ingest Service в render-server обрабатывает загруженные фото/видео: валидация, конвертация, оптимизация, сохранение в хранилище.

---

## 8. Как внутри Ingest происходит обработка фото/видео?

**Ответ:** Валидация формата → конвертация в рабочий формат → ресайз/оптимизация → извлечение метаданных → сохранение.

---

## 9. Каким образом выполняется финальная склейка роликов и какая библиотека используется?

**Ответ:** FFmpeg или moviepy (детали в render-server). Процесс: загрузка сегментов → применение эффектов → склейка → финальный рендер.

---

## 10. Есть ли очередь задач и какая технология используется для очередей?

**Ответ:** Да, в render-server используется очередь (Redis/Bull/Inngest). Задачи ставятся в очередь после приема запроса.

---

## 11. Сколько параллельных рендер-задач система может выдерживать сейчас?

**Ответ:** Зависит от конфигурации render-server и лимитов внешних API (Veo/Hedra/HeyGen). С собственным GPU-оборудованием количество параллельных задач ограничено только мощностью GPU и конфигурацией системы.

---

## 12. Какие таблицы есть в Neon DB и какая у них структура?

**Ответ:** В render-server используются таблицы: `render_tasks`, `templates`, `media_files`, `render_results`, `user_sessions`. Структура в схеме БД render-server.

---

## 13. Как хранятся задачи, шаблоны, статусы, результаты и ссылки на медиа?

**Ответ:** Задачи и статусы — в `render_tasks`. Шаблоны — в `templates` (JSON). Медиа — в `media_files` с ссылками на S3/хранилище. Результаты — в `render_results`.

---

## 14. Как логируются ошибки и где они сохраняются?

**Ответ:** Ошибки логируются в таблицу `logs` в Neon DB и отправляются в Sentry (если настроено). Структура логов: timestamp, task_id, error_type, message, stack_trace.

---

## 15. Нужно ли расширить БД для тренд-модуля и сценариев?

**Ответ:** Да, потребуются таблицы: `trends`, `scenarios`, `trend_sources`, `scenario_templates`. Детали в плане развития render-server.

---

## 16. Как сейчас устроены два существующих шаблона — в виде JSON, hardcode или цепочки вызовов?

**Ответ:** Шаблоны хранятся в БД как JSON с параметрами (длительность, переходы, эффекты). Обрабатываются Template Engine в render-server.

---

## 17. Можно ли динамически менять параметры шаблона?

**Ответ:** Да, параметры шаблона настраиваются через API/конфиг перед рендером.

---

## 18. Какие параметры шаблона уже можно изменять (длительность, переходы, zoom и т.д.)?

**Ответ:** Длительность, переходы, zoom, скорость, эффекты, субтитры. Полный список в документации Template Engine render-server.

---

## 19. Есть ли ограничения по длине роликов?

**Ответ:** Нет, ограничений по длине нет. Можно склеивать видео друг с другом, создавая ролики любой длины. Ограничения внешних сервисов (Veo/Hedra/HeyGen) обходятся за счет склейки нескольких сегментов.

---

## 20. Как лучше реализовать систему продвинутых AI-шаблонов с монтажом?

**Ответ:** Используются шаблоны Adobe After Effects. Все эффекты и монтаж доступны через After Effects. Можно создавать продвинутые AI-шаблоны с любыми эффектами, которые поддерживает After Effects. Проблема в создании качественных шаблонов — нужен профессиональный дизайнер/монтажер.

---

## 21. Какие монтажные процессы уже можно автоматизировать на текущей архитектуре?

**Ответ:** Используются шаблоны Adobe After Effects. Все, что можно сделать в After Effects, можно срендерить и заменить любые слои. Автоматизированы: склейка сегментов, применение переходов, добавление субтитров, наложение эффектов, синхронизация аудио/видео, замена слоев в шаблонах.

---

## 22. Как проще реализовать jump cuts, match cuts, пан/зумы, вставку b-roll, speed ramp?

**Ответ:** Все эффекты уже доступны через шаблоны Adobe After Effects. Jump cuts, match cuts, пан/зумы, вставка b-roll, speed ramp — все реализовано через After Effects шаблоны. Проблема не в технической реализации, а в создании красивых шаблонов дизайнером/монтажером.

---

## 23. Какие из эффектов технически проще внедрить в первую очередь?

**Ответ:** Все эффекты уже внедрены через Adobe After Effects. Все, что можно сделать в After Effects, доступно в системе. Проблема не в технической реализации эффектов, а в создании красивых шаблонов профессиональным дизайнером/монтажером. Нужен эксперт для создания качественных шаблонов.

---

## 24. Какие библиотеки или движки планируешь использовать для монтажа (FFmpeg, moviepy, custom)?

**Ответ:** В render-server используется Adobe After Effects для рендеринга шаблонов. FFmpeg и moviepy используются для дополнительной обработки и финальной склейки. Все эффекты реализованы через After Effects шаблоны.

---

## 25. Какие технологии лучше использовать для авто-субтитров?

**Ответ:** Whisper (OpenAI) для транскрипции, синхронизация через WebVTT/SRT. Рендер субтитров через FFmpeg.

---

## 26. Как лучше хранить параметры стиля субтитров?

**Ответ:** В JSON-конфиге шаблона: шрифт, размер, цвет, позиция, анимация, timing.

---

## 27. Какие варианты кастомизации субтитров реально внедрить первыми?

**Ответ:** Шрифт, размер, цвет, позиция (верх/низ), timing. Позже: анимация, стили, мультиязычность.

---

## 28. Есть ли уже интеграции с LLM/скриптом/тренд-источниками?

**Ответ:** В render-server есть интеграции с LLM для генерации скриптов.

---

## 29. Как ты видишь реализацию AutoScript Engine в рамках текущего пайплайна?

**Ответ:** AutoScript Engine в render-server: LLM генерирует скрипт на основе трендов/темы → валидация → разбивка на сегменты → передача в рендер.

---

## 30. Можно ли подключить источники трендов (Apify, TikTok, Reels, Shorts) на текущей архитектуре?

**Ответ:** Да, через отдельный модуль Trend Aggregator в render-server. Парсинг через Apify, TikTok API, RSS-фиды.

---

## 31. Какие ограничения по масштабируемости есть сейчас?

**Ответ:**

**Основные ограничения:**

- Отсутствие финансирования (невозможность масштабирования без оплаты нейросетей и инфраструктуры)
- Отсутствие собственного GPU-оборудования (зависимость от внешних API, высокая стоимость)
- Лимиты внешних API (Veo/Hedra/HeyGen)
- Пропускная способность очереди
- Размер БД, хранилище медиа
- Нехватка экспертов для создания шаблонов

**Для масштабирования требуется:**

- Финансирование
- Собственное GPU-оборудование (локальный сервер)
- Горизонтальное масштабирование инфраструктуры
- Команда экспертов (видеомонтажеры, дизайнеры)

---

## 32. Сколько роликов в сутки система реально может генерировать?

**Ответ:** Система масштабируется под любой объем по запросу. Свой сервер с GPU будет дешевле всего — на нем будет происходить рендеринг. Для ускорения процесса и снижения затрат необходим собственный GPU, который нужно установить локально. С собственным оборудованием можно генерировать любое количество роликов в сутки в зависимости от мощности GPU и конфигурации.

---

## 33. Что нужно добавить/изменить, чтобы выйти на 200+ роликов в сутки?

**Ответ:**

**Критически важно:**

- Финансирование для оплаты нейросетей и инфраструктуры
- Собственное GPU-оборудование (локальный сервер с GPU для дешевого рендеринга)

**Технические улучшения:**

- Масштабирование очереди
- Увеличение параллельных воркеров
- Кэширование
- Оптимизация рендера
- Резервирование API-квот (или переход на собственный GPU)

---

## 34. Есть ли внутренний API для рендера или orchestration?

**Ответ:** Да, в render-server есть внутренний Render API и Orchestration Service для управления пайплайном.

---

## 35. Нужно ли вынести Render API, Template API и Script API в отдельные сервисы?

**Ответ:** Текущая архитектура render-server уже поддерживает разделение на модули. Для масштабирования рекомендуется микросервисная архитектура: каждый API (Render API, Template API, Script API) — отдельный сервис с общей очередью и БД. Это упростит масштабирование и независимое развертывание компонентов.

---
