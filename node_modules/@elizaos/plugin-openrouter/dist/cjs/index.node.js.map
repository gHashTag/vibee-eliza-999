{
  "version": 3,
  "sources": ["../../src/index.ts", "../../src/init.ts", "../../src/utils/config.ts", "../../src/models/text.ts", "../../src/providers/openrouter.ts", "../../src/utils/events.ts", "../../src/utils/helpers.ts", "../../src/models/object.ts", "../../src/models/image.ts", "../../src/utils/image-storage.ts", "../../src/models/embedding.ts"],
  "sourcesContent": [
    "import {\n  ModelType,\n  type Plugin,\n  type IAgentRuntime,\n  type GenerateTextParams,\n  type ObjectGenerationParams,\n  type ImageDescriptionParams,\n  type ImageGenerationParams,\n  type TextEmbeddingParams,\n} from '@elizaos/core';\nimport type { Tool, ToolChoice } from 'ai';\nimport { initializeOpenRouter } from './init';\nimport { handleTextSmall, handleTextLarge } from './models/text';\nimport { handleObjectSmall, handleObjectLarge } from './models/object';\nimport { handleImageDescription, handleImageGeneration } from './models/image';\nimport { handleTextEmbedding } from './models/embedding';\n\n/**\n * Defines the OpenRouter plugin with its name, description, and configuration options.\n * @type {Plugin}\n */\nexport const openrouterPlugin: Plugin = {\n  name: 'openrouter',\n  description: 'OpenRouter plugin',\n  config: {\n    OPENROUTER_API_KEY: process.env.OPENROUTER_API_KEY,\n    OPENROUTER_BASE_URL: process.env.OPENROUTER_BASE_URL,\n    OPENROUTER_SMALL_MODEL: process.env.OPENROUTER_SMALL_MODEL,\n    OPENROUTER_LARGE_MODEL: process.env.OPENROUTER_LARGE_MODEL,\n    OPENROUTER_IMAGE_MODEL: process.env.OPENROUTER_IMAGE_MODEL,\n    OPENROUTER_IMAGE_GENERATION_MODEL: process.env.OPENROUTER_IMAGE_GENERATION_MODEL,\n    OPENROUTER_EMBEDDING_MODEL: process.env.OPENROUTER_EMBEDDING_MODEL,\n    OPENROUTER_EMBEDDING_DIMENSIONS: process.env.OPENROUTER_EMBEDDING_DIMENSIONS,\n    OPENROUTER_AUTO_CLEANUP_IMAGES: process.env.OPENROUTER_AUTO_CLEANUP_IMAGES,\n    SMALL_MODEL: process.env.SMALL_MODEL,\n    LARGE_MODEL: process.env.LARGE_MODEL,\n    IMAGE_MODEL: process.env.IMAGE_MODEL,\n    IMAGE_GENERATION_MODEL: process.env.IMAGE_GENERATION_MODEL,\n    EMBEDDING_MODEL: process.env.EMBEDDING_MODEL,\n    EMBEDDING_DIMENSIONS: process.env.EMBEDDING_DIMENSIONS,\n  },\n  async init(config, runtime) {\n    // Note: We intentionally don't await here because ElizaOS expects\n    // the init method to return quickly. The initializeOpenRouter function\n    // only performs synchronous validation and logging, so it's safe to\n    // call without await. This prevents blocking the plugin initialization.\n    initializeOpenRouter(config, runtime);\n  },\n  models: {\n    [ModelType.TEXT_SMALL]: async (\n      runtime: IAgentRuntime,\n      params: GenerateTextParams & {\n        tools?: Record<string, Tool>;\n        toolChoice?: ToolChoice<Record<string, Tool>>;\n      }\n    ) => {\n      return handleTextSmall(runtime, params);\n    },\n    [ModelType.TEXT_LARGE]: async (\n      runtime: IAgentRuntime,\n      params: GenerateTextParams & {\n        tools?: Record<string, Tool>;\n        toolChoice?: ToolChoice<Record<string, Tool>>;\n      }\n    ) => {\n      return handleTextLarge(runtime, params);\n    },\n    [ModelType.OBJECT_SMALL]: async (runtime: IAgentRuntime, params: ObjectGenerationParams) => {\n      return handleObjectSmall(runtime, params);\n    },\n    [ModelType.OBJECT_LARGE]: async (runtime: IAgentRuntime, params: ObjectGenerationParams) => {\n      return handleObjectLarge(runtime, params);\n    },\n    [ModelType.IMAGE_DESCRIPTION]: async (\n      runtime: IAgentRuntime,\n      params: ImageDescriptionParams | string\n    ) => {\n      return handleImageDescription(runtime, params);\n    },\n    [ModelType.IMAGE]: async (runtime: IAgentRuntime, params: ImageGenerationParams) => {\n      return handleImageGeneration(runtime, params);\n    },\n    [ModelType.TEXT_EMBEDDING]: async (\n      runtime: IAgentRuntime,\n      params: TextEmbeddingParams | string | null\n    ) => {\n      return handleTextEmbedding(runtime, params);\n    },\n  },\n};\n\nexport default openrouterPlugin;\n",
    "import { logger, type IAgentRuntime } from \"@elizaos/core\";\nimport { fetch } from \"undici\";\nimport { getApiKey, getBaseURL } from \"./utils/config\";\n\n/**\n * Initialize and validate OpenRouter configuration\n * Returns the exact same function that works inline\n */\nexport function initializeOpenRouter(_config: any, runtime: IAgentRuntime) {\n  // do check in the background\n  (async () => {\n    try {\n      const isBrowser =\n        typeof globalThis !== \"undefined\" && (globalThis as any).document;\n      // In browser, skip validation entirely to avoid exposing secrets\n      if (isBrowser) {\n        return;\n      }\n      if (!getApiKey(runtime)) {\n        logger.warn(\n          \"OPENROUTER_API_KEY is not set in environment - OpenRouter functionality will be limited\",\n        );\n        return;\n      }\n      try {\n        const baseURL = getBaseURL(runtime);\n        const response = await fetch(`${baseURL}/models`, {\n          headers: { Authorization: `Bearer ${getApiKey(runtime)}` },\n        });\n        if (!response.ok) {\n          logger.warn(\n            `OpenRouter API key validation failed: ${response.statusText}`,\n          );\n          logger.warn(\n            \"OpenRouter functionality will be limited until a valid API key is provided\",\n          );\n        } else {\n          logger.log(\"OpenRouter API key validated successfully\");\n        }\n      } catch (fetchError: unknown) {\n        const message =\n          fetchError instanceof Error ? fetchError.message : String(fetchError);\n        logger.warn(`Error validating OpenRouter API key: ${message}`);\n        logger.warn(\n          \"OpenRouter functionality will be limited until a valid API key is provided\",\n        );\n      }\n    } catch (error: unknown) {\n      const message =\n        (error as { errors?: Array<{ message: string }> })?.errors\n          ?.map((e) => e.message)\n          .join(\", \") ||\n        (error instanceof Error ? error.message : String(error));\n      logger.warn(\n        `OpenRouter plugin configuration issue: ${message} - You need to configure the OPENROUTER_API_KEY in your environment variables`,\n      );\n    }\n  })();\n  return;\n}\n",
    "import type { IAgentRuntime } from '@elizaos/core';\n\n/**\n * Retrieves a configuration setting from the runtime, falling back to environment variables or a default value if not found.\n *\n * @param key - The name of the setting to retrieve.\n * @param defaultValue - The value to return if the setting is not found in the runtime or environment.\n * @returns The resolved setting value, or {@link defaultValue} if not found.\n */\nexport function getSetting(\n  runtime: IAgentRuntime,\n  key: string,\n  defaultValue?: string\n): string | undefined {\n  return runtime.getSetting(key) ?? process.env[key] ?? defaultValue;\n}\n\n/**\n * Retrieves the OpenRouter API base URL from runtime settings, environment variables, or defaults.\n *\n * @returns The resolved base URL for OpenRouter API requests.\n */\nexport function getBaseURL(runtime: IAgentRuntime): string {\n  const browserURL = getSetting(runtime, 'OPENROUTER_BROWSER_BASE_URL');\n  if (typeof globalThis !== 'undefined' && (globalThis as any).document && browserURL) {\n    return browserURL;\n  }\n  return (\n    getSetting(runtime, 'OPENROUTER_BASE_URL', 'https://openrouter.ai/api/v1') ||\n    'https://openrouter.ai/api/v1'\n  );\n}\n\n/**\n * Helper function to get the API key for OpenRouter\n *\n * @param runtime The runtime context\n * @returns The configured API key\n */\nexport function getApiKey(runtime: IAgentRuntime): string | undefined {\n  return getSetting(runtime, 'OPENROUTER_API_KEY');\n}\n\n/**\n * Helper function to get the small model name with fallbacks\n *\n * @param runtime The runtime context\n * @returns The configured small model name\n */\nexport function getSmallModel(runtime: IAgentRuntime): string {\n  return (\n    getSetting(runtime, 'OPENROUTER_SMALL_MODEL') ??\n    getSetting(runtime, 'SMALL_MODEL', 'google/gemini-2.0-flash-001') ??\n    'google/gemini-2.0-flash-001'\n  );\n}\n\n/**\n * Helper function to get the large model name with fallbacks\n *\n * @param runtime The runtime context\n * @returns The configured large model name\n */\nexport function getLargeModel(runtime: IAgentRuntime): string {\n  return (\n    getSetting(runtime, 'OPENROUTER_LARGE_MODEL') ??\n    getSetting(runtime, 'LARGE_MODEL', 'google/gemini-2.5-flash') ??\n    'google/gemini-2.5-flash'\n  );\n}\n\n/**\n * Helper function to get the image model name with fallbacks\n *\n * @param runtime The runtime context\n * @returns The configured image model name\n */\nexport function getImageModel(runtime: IAgentRuntime): string {\n  return (\n    getSetting(runtime, 'OPENROUTER_IMAGE_MODEL') ??\n    getSetting(runtime, 'IMAGE_MODEL', 'x-ai/grok-2-vision-1212') ??\n    'x-ai/grok-2-vision-1212'\n  );\n}\n\n/**\n * Helper function to get the image generation model name with fallbacks\n *\n * @param runtime The runtime context\n * @returns The configured image generation model name\n */\nexport function getImageGenerationModel(runtime: IAgentRuntime): string {\n  return (\n    getSetting(runtime, 'OPENROUTER_IMAGE_GENERATION_MODEL') ??\n    getSetting(runtime, 'IMAGE_GENERATION_MODEL', 'google/gemini-2.5-flash-image-preview') ??\n    'google/gemini-2.5-flash-image-preview'\n  );\n}\n\n/**\n * Helper function to get the embedding model name with fallbacks\n *\n * @param runtime The runtime context\n * @returns The configured embedding model name\n */\nexport function getEmbeddingModel(runtime: IAgentRuntime): string {\n  return (\n    getSetting(runtime, 'OPENROUTER_EMBEDDING_MODEL') ??\n    getSetting(runtime, 'EMBEDDING_MODEL', 'openai/text-embedding-3-small') ??\n    'openai/text-embedding-3-small'\n  );\n}\n\n/**\n * Helper function to check if auto cleanup is enabled for generated images\n *\n * @param runtime The runtime context\n * @returns Whether to auto-cleanup generated images (default: false)\n */\nexport function shouldAutoCleanupImages(runtime: IAgentRuntime): boolean {\n  const setting = getSetting(runtime, 'OPENROUTER_AUTO_CLEANUP_IMAGES', 'false');\n  return setting?.toLowerCase() === 'true';\n}\n\n/**\n * Helper function to get the max steps for tool execution\n *\n * @param runtime The runtime context\n * @returns The maximum number of steps for tool execution (default: 15)\n */\nexport function getToolExecutionMaxSteps(runtime: IAgentRuntime): number {\n  const setting = getSetting(runtime, 'OPENROUTER_TOOL_EXECUTION_MAX_STEPS', '15');\n  const value = parseInt(setting || '15', 10);\n  // Ensure valid range (1-100)\n  if (Number.isNaN(value) || value < 1) return 15;\n  if (value > 100) return 100;\n  return value;\n}\n",
    "import type { GenerateTextParams, IAgentRuntime } from \"@elizaos/core\";\nimport { logger, ModelType } from \"@elizaos/core\";\nimport { generateText, stepCountIs } from \"ai\";\nimport type { Tool, ToolChoice } from \"ai\";\n\nimport { createOpenRouterProvider } from \"../providers\";\nimport type { ToolCall, ToolResponse, ToolResult } from \"../types\";\nimport { getSmallModel, getLargeModel, getToolExecutionMaxSteps } from \"../utils/config\";\nimport { emitModelUsageEvent } from \"../utils/events\";\nimport { handleEmptyToolResponse, decodeBase64Fields } from \"../utils/helpers\";\n\n/**\n * Common text generation logic for both small and large models\n */\nasync function generateTextWithModel(\n  runtime: IAgentRuntime,\n  modelType: typeof ModelType.TEXT_SMALL | typeof ModelType.TEXT_LARGE,\n  params: GenerateTextParams & {\n    tools?: Record<string, Tool>;\n    toolChoice?: ToolChoice<Record<string, Tool>>;\n  },\n): Promise<string | ToolResponse> {\n  const { prompt, stopSequences = [], tools, toolChoice } = params;\n  const temperature = params.temperature ?? 0.7;\n  const frequencyPenalty = params.frequencyPenalty ?? 0.7;\n  const presencePenalty = params.presencePenalty ?? 0.7;\n  // AI SDK v5: prefer maxOutputTokens; keep legacy maxTokens as fallback; default 8192\n  const resolvedMaxOutput =\n    (params as any).maxOutputTokens ?? (params as any).maxTokens ?? 8192;\n\n  const openrouter = createOpenRouterProvider(runtime);\n  const modelName =\n    modelType === ModelType.TEXT_SMALL\n      ? getSmallModel(runtime)\n      : getLargeModel(runtime);\n  const modelLabel =\n    modelType === ModelType.TEXT_SMALL ? \"TEXT_SMALL\" : \"TEXT_LARGE\";\n\n  logger.debug(\n    `[OpenRouter] Generating text with ${modelLabel} model: ${modelName}`,\n  );\n\n  const generateParams: Parameters<typeof generateText>[0] = {\n    model: openrouter.chat(modelName),\n    prompt: prompt,\n    system: runtime.character.system ?? undefined,\n    temperature: temperature,\n    frequencyPenalty: frequencyPenalty,\n    presencePenalty: presencePenalty,\n    stopSequences: stopSequences,\n  };\n\n  (generateParams as any).maxOutputTokens = resolvedMaxOutput;\n\n  // Add tools if provided\n  if (tools) {\n    (generateParams as any).tools = tools;\n    const maxSteps = getToolExecutionMaxSteps(runtime);\n\n    (generateParams as any).stopWhen = stepCountIs(maxSteps);\n    logger.debug(`[OpenRouter] Using maxSteps: ${maxSteps} for tool execution`);\n  }\n\n  // Add toolChoice if provided\n  if (toolChoice) {\n    (generateParams as any).toolChoice = toolChoice;\n  }\n\n  // Capture tool results if tools are used\n  let capturedToolResults: ToolResult[] = [];\n  let capturedToolCalls: ToolCall[] = [];\n\n  if (tools) {\n    (generateParams as any).onStepFinish = async (stepResult: any) => {\n      if (stepResult.toolCalls && stepResult.toolCalls.length > 0) {\n        capturedToolCalls = [\n          ...capturedToolCalls,\n          ...(stepResult.toolCalls as any),\n        ];\n      }\n\n      // Extract tool results from content array in steps\n      if (stepResult.content && Array.isArray(stepResult.content)) {\n        const toolResultsFromContent = stepResult.content\n          .filter((content: any) => content.type === 'tool-result' && content.output)\n          .map((content: any) => ({\n            toolCallId: content.toolCallId,\n            result: decodeBase64Fields(content.output),\n          }));\n\n        if (toolResultsFromContent.length > 0) {\n          capturedToolResults = [...capturedToolResults, ...toolResultsFromContent];\n        }\n      }\n    };\n  }\n\n  const response = await generateText(generateParams);\n\n  // Handle cases where tool execution doesn't generate text\n  let responseText: string;\n  if (\n    tools &&\n    (!response.text ||\n      response.text.trim() === \"\" ||\n      response.text === \"Tools executed successfully.\")\n  ) {\n    responseText = handleEmptyToolResponse(modelLabel);\n  } else {\n    responseText = response.text;\n  }\n\n  if (response.usage) {\n    emitModelUsageEvent(runtime, modelType, prompt, response.usage);\n  }\n\n  // If tools were used, return the full response object with steps for proper tool results access\n  if (tools && response.steps && response.steps.length > 0) {\n    return {\n      text: responseText,\n      toolCalls: capturedToolCalls,\n      toolResults: capturedToolResults,\n      steps: response.steps,\n      usage: response.usage,\n      finishReason: response.finishReason,\n    };\n  }\n\n  return responseText;\n}\n\n/**\n * TEXT_SMALL model handler\n */\nexport async function handleTextSmall(\n  runtime: IAgentRuntime,\n  params: GenerateTextParams & {\n    tools?: Record<string, Tool>;\n    toolChoice?: ToolChoice<Record<string, Tool>>;\n  },\n): Promise<string | ToolResponse> {\n  return generateTextWithModel(runtime, ModelType.TEXT_SMALL, params);\n}\n\n/**\n * TEXT_LARGE model handler\n */\nexport async function handleTextLarge(\n  runtime: IAgentRuntime,\n  params: GenerateTextParams & {\n    tools?: Record<string, Tool>;\n    toolChoice?: ToolChoice<Record<string, Tool>>;\n  },\n): Promise<string | ToolResponse> {\n  return generateTextWithModel(runtime, ModelType.TEXT_LARGE, params);\n}\n",
    "import { createOpenRouter } from \"@openrouter/ai-sdk-provider\";\nimport { logger, type IAgentRuntime } from \"@elizaos/core\";\nimport { getApiKey, getBaseURL } from \"../utils/config\";\n\n/**\n * Create an OpenRouter provider instance with proper configuration\n *\n * @param runtime The runtime context\n * @returns Configured OpenRouter provider instance\n */\nexport function createOpenRouterProvider(runtime: IAgentRuntime) {\n  const apiKey = getApiKey(runtime);\n  const isBrowser =\n    typeof globalThis !== \"undefined\" && (globalThis as any).document;\n  const baseURL = getBaseURL(runtime);\n  // In browser, omit apiKey and rely on proxy baseURL\n  return createOpenRouter({\n    apiKey: isBrowser ? undefined : apiKey,\n    baseURL,\n  });\n}\n",
    "import {\n  EventType,\n  type IAgentRuntime,\n  type ModelTypeName,\n} from \"@elizaos/core\";\nimport type { LanguageModelUsage } from \"ai\";\n\n/**\n * Emits a model usage event\n */\nexport function emitModelUsageEvent(\n  runtime: IAgentRuntime,\n  type: ModelTypeName,\n  prompt: string,\n  usage: LanguageModelUsage,\n) {\n  // Never emit the full prompt; truncate to avoid leaking secrets/PII\n  const truncatedPrompt =\n    typeof prompt === \"string\"\n      ? prompt.length > 200\n        ? `${prompt.slice(0, 200)}â€¦`\n        : prompt\n      : \"\";\n  // Coalesce optional usage fields to stable numbers\n  const inputTokens = Number((usage as { inputTokens?: number }).inputTokens || 0);\n  const outputTokens = Number((usage as { outputTokens?: number }).outputTokens || 0);\n  const totalTokens = Number(\n    usage.totalTokens != null ? usage.totalTokens : inputTokens + outputTokens,\n  );\n  runtime.emitEvent(EventType.MODEL_USED, {\n    provider: \"openrouter\",\n    type,\n    prompt: truncatedPrompt,\n    tokens: {\n      prompt: inputTokens,\n      completion: outputTokens,\n      total: totalTokens,\n    },\n  });\n}\n",
    "import { logger } from \"@elizaos/core\";\nimport { JSONParseError } from \"ai\";\nimport type { GenerateTextResponse, ImageDescriptionResult } from \"../types\";\n\n/**\n * Returns a function to repair JSON text\n */\nexport function getJsonRepairFunction(): (params: {\n  text: string;\n  error: unknown;\n}) => Promise<string | null> {\n  return async ({ text, error }: { text: string; error: unknown }) => {\n    try {\n      if (error instanceof JSONParseError) {\n        const cleanedText = text.replace(/```json\\n|\\n```|```/g, \"\");\n        JSON.parse(cleanedText);\n        return cleanedText;\n      }\n      return null;\n    } catch (jsonError: unknown) {\n      const message =\n        jsonError instanceof Error ? jsonError.message : String(jsonError);\n      logger.warn(`Failed to repair JSON text: ${message}`);\n      return null;\n    }\n  };\n}\n\n// Re-export for backward compatibility\nexport { emitModelUsageEvent } from \"./events\";\n\n/**\n * Logs response structure for debugging (debug level only)\n */\nexport function logResponseStructure(\n  modelType: string,\n  response: GenerateTextResponse,\n) {\n  // Only log safe, non-sensitive usage fields (avoid raw request bodies)\n  const u = (response as any)?.usage;\n  const safeUsage =\n    u && typeof u === \"object\"\n      ? {\n          inputTokens: u.inputTokens,\n          outputTokens: u.outputTokens,\n          totalTokens: u.totalTokens,\n        }\n      : undefined;\n  logger.debug(\n    `[${modelType}] Response structure: ${JSON.stringify(\n      {\n        hasText: !!response.text,\n        textLength: response.text?.length || 0,\n        hasSteps: !!response.steps,\n        stepsCount: response.steps?.length || 0,\n        finishReason: response.finishReason,\n        usage: safeUsage,\n      },\n      null,\n      2,\n    )}`,\n  );\n}\n\n/**\n * Handles cases where tool execution doesn't generate text\n */\nexport function handleEmptyToolResponse(modelType: string): string {\n  logger.warn(`[${modelType}] No text generated after tool execution`);\n\n  const fallbackText =\n    \"I executed the requested action. The tool completed successfully.\";\n  logger.warn(`[${modelType}] Using fallback response text`);\n  return fallbackText;\n}\n\n/**\n * Parses image description response from text or JSON format\n */\nexport function parseImageDescriptionResponse(\n  responseText: string,\n): ImageDescriptionResult {\n  // Try to parse as JSON first\n  try {\n    const jsonResponse = JSON.parse(responseText);\n    if (jsonResponse.title && jsonResponse.description) {\n      return jsonResponse;\n    }\n  } catch (e) {\n    // If not valid JSON, process as text\n    logger.debug(`Parsing as JSON failed, processing as text: ${e}`);\n  }\n\n  // Extract title and description from text format\n  const titleMatch = responseText.match(/title[:\\s]+(.+?)(?:\\n|$)/i);\n  const title = titleMatch?.[1]?.trim() || \"Image Analysis\";\n  const description = responseText\n    .replace(/title[:\\s]+(.+?)(?:\\n|$)/i, \"\")\n    .trim();\n\n  return { title, description };\n}\n\n/**\n * Handles errors during object generation, including JSON repair attempts\n */\nexport async function handleObjectGenerationError(\n  error: unknown,\n): Promise<unknown> {\n  if (error instanceof JSONParseError) {\n    logger.error(`[generateObject] Failed to parse JSON: ${error.message}`);\n    const repairFunction = getJsonRepairFunction();\n    const repairedJsonString = await repairFunction({\n      text: error.text,\n      error,\n    });\n\n    if (repairedJsonString) {\n      try {\n        const repairedObject = JSON.parse(repairedJsonString);\n        logger.log(\"[generateObject] Successfully repaired JSON.\");\n        return repairedObject;\n      } catch (repairParseError: unknown) {\n        const message =\n          repairParseError instanceof Error\n            ? repairParseError.message\n            : String(repairParseError);\n        logger.error(\n          `[generateObject] Failed to parse repaired JSON: ${message}`,\n        );\n        if (repairParseError instanceof Error) throw repairParseError;\n        throw Object.assign(new Error(message), { cause: repairParseError });\n      }\n    } else {\n      logger.error(\"[generateObject] JSON repair failed.\");\n      throw error;\n    }\n  } else {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error(`[generateObject] Unknown error: ${message}`);\n    if (error instanceof Error) throw error;\n    throw Object.assign(new Error(message), { cause: error });\n  }\n}\n\n/**\n * Quick heuristic to detect if a field likely contains base64 data\n */\nfunction isLikelyBase64(key: string, value: string): boolean {\n  // Check key name patterns (expanded base64 field names)\n  const base64KeyPattern =\n    /^(data|content|body|payload|encoded|b64|base64|document)$/i;\n  if (!base64KeyPattern.test(key)) return false;\n\n  // Basic format checks\n  if (value.length < 20 || value.length > 1024 * 1024) return false; // Size limits\n  if (value.length % 4 !== 0) return false; // Invalid base64 length\n  if (!/^[A-Za-z0-9+/]*={0,2}$/.test(value)) return false; // Invalid chars\n\n  return true;\n}\n\n/**\n * Recursively decodes base64 fields in tool results\n */\nexport function decodeBase64Fields(obj: unknown, depth = 0): unknown {\n  // Simple depth protection\n  if (depth > 5) return obj;\n  if (!obj || typeof obj !== \"object\") return obj;\n  if (Array.isArray(obj))\n    return obj.map((item) => decodeBase64Fields(item, depth + 1));\n\n  const decoded: Record<string, unknown> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (typeof value === \"string\" && isLikelyBase64(key, value)) {\n      try {\n        decoded[key] = Buffer.from(value, \"base64\").toString(\"utf8\");\n        logger.debug(\n          `[decodeBase64] Decoded field '${key}' (${value.length} chars)`,\n        );\n      } catch (error) {\n        logger.warn(`[decodeBase64] Failed to decode field '${key}': ${error}`);\n        decoded[key] = value; // Keep original if decode fails\n      }\n    } else if (value && typeof value === \"object\") {\n      decoded[key] = decodeBase64Fields(value, depth + 1);\n    } else {\n      decoded[key] = value;\n    }\n  }\n  return decoded;\n}\n",
    "import {\n  ModelType,\n  logger,\n  type IAgentRuntime,\n  type ObjectGenerationParams,\n} from \"@elizaos/core\";\nimport { generateObject } from \"ai\";\nimport { createOpenRouterProvider } from \"../providers\";\nimport { getSmallModel, getLargeModel } from \"../utils/config\";\nimport { emitModelUsageEvent } from \"../utils/events\";\nimport {\n  getJsonRepairFunction,\n  handleObjectGenerationError,\n} from \"../utils/helpers\";\n\n/**\n * Common object generation logic for both small and large models\n */\nasync function generateObjectWithModel(\n  runtime: IAgentRuntime,\n  modelType: typeof ModelType.OBJECT_SMALL | typeof ModelType.OBJECT_LARGE,\n  params: ObjectGenerationParams,\n): Promise<unknown> {\n  const openrouter = createOpenRouterProvider(runtime);\n  const modelName =\n    modelType === ModelType.OBJECT_SMALL\n      ? getSmallModel(runtime)\n      : getLargeModel(runtime);\n  const modelLabel =\n    modelType === ModelType.OBJECT_SMALL ? \"OBJECT_SMALL\" : \"OBJECT_LARGE\";\n\n  logger.log(`[OpenRouter] Using ${modelLabel} model: ${modelName}`);\n  const temperature = params.temperature ?? 0.7;\n\n  try {\n    const { object, usage } = await generateObject({\n      model: openrouter.chat(modelName),\n      ...(params.schema && { schema: params.schema }),\n      output: (params.schema ? \"object\" : \"no-schema\") as any,\n      prompt: params.prompt,\n      temperature: temperature,\n      experimental_repairText: getJsonRepairFunction(),\n    });\n\n    if (usage) {\n      emitModelUsageEvent(runtime, modelType, params.prompt, usage);\n    }\n    return object;\n  } catch (error: unknown) {\n    return handleObjectGenerationError(error);\n  }\n}\n\n/**\n * OBJECT_SMALL model handler\n */\nexport async function handleObjectSmall(\n  runtime: IAgentRuntime,\n  params: ObjectGenerationParams,\n): Promise<unknown> {\n  return generateObjectWithModel(runtime, ModelType.OBJECT_SMALL, params);\n}\n\n/**\n * OBJECT_LARGE model handler\n */\nexport async function handleObjectLarge(\n  runtime: IAgentRuntime,\n  params: ObjectGenerationParams,\n): Promise<unknown> {\n  return generateObjectWithModel(runtime, ModelType.OBJECT_LARGE, params);\n}\n",
    "import {\n  logger,\n  type IAgentRuntime,\n  type ImageDescriptionParams,\n  type ImageGenerationParams,\n} from \"@elizaos/core\";\nimport { generateText } from \"ai\";\nimport type { OpenRouterImageResponse } from \"../types\";\nimport { createOpenRouterProvider } from \"../providers\";\nimport {\n  getApiKey,\n  getBaseURL,\n  getImageGenerationModel,\n  getImageModel,\n  shouldAutoCleanupImages,\n} from \"../utils/config\";\nimport { parseImageDescriptionResponse } from \"../utils/helpers\";\nimport { deleteImage, saveBase64Image } from \"../utils/image-storage\";\n\n/**\n * IMAGE_DESCRIPTION model handler\n */\nexport async function handleImageDescription(\n  runtime: IAgentRuntime,\n  params: ImageDescriptionParams | string,\n): Promise<{ title: string; description: string }> {\n  let imageUrl: string;\n  let promptText: string | undefined;\n  const modelName = getImageModel(runtime);\n  logger.log(`[OpenRouter] Using IMAGE_DESCRIPTION model: ${modelName}`);\n  const maxOutputTokens = 300;\n\n  if (typeof params === \"string\") {\n    imageUrl = params;\n    promptText =\n      \"Please analyze this image and provide a title and detailed description.\";\n  } else {\n    imageUrl = params.imageUrl;\n    promptText =\n      params.prompt ||\n      \"Please analyze this image and provide a title and detailed description.\";\n  }\n\n  const openrouter = createOpenRouterProvider(runtime);\n\n  const messages = [\n    {\n      role: \"user\" as const,\n      content: [\n        { type: \"text\" as const, text: promptText },\n        { type: \"image\" as const, image: imageUrl },\n      ],\n    },\n  ];\n\n  try {\n    const model = openrouter.chat(modelName);\n\n    const { text: responseText } = await generateText({\n      model: model,\n      messages: messages,\n      maxOutputTokens: maxOutputTokens,\n    });\n\n    return parseImageDescriptionResponse(responseText);\n  } catch (error: unknown) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error(`Error analyzing image: ${message}`);\n    return {\n      title: \"Failed to analyze image\",\n      description: `Error: ${message}`,\n    };\n  }\n}\n\n/**\n * IMAGE model handler for image generation\n */\nexport async function handleImageGeneration(\n  runtime: IAgentRuntime,\n  params: ImageGenerationParams,\n): Promise<{ url: string }[]> {\n  const modelName = getImageGenerationModel(runtime);\n  logger.log(`[OpenRouter] Using IMAGE_GENERATION model: ${modelName}`);\n  const apiKey = getApiKey(runtime);\n\n  try {\n    const baseUrl = getBaseURL(runtime);\n    const isBrowser =\n      typeof globalThis !== \"undefined\" && (globalThis as any).document;\n    const response = await fetch(`${baseUrl}/chat/completions`, {\n      method: \"POST\",\n      headers: {\n        ...(isBrowser ? {} : { Authorization: `Bearer ${apiKey}` }),\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model: modelName,\n        messages: [\n          {\n            role: \"user\",\n            content: params.prompt,\n          },\n        ],\n        modalities: [\"image\", \"text\"],\n      }),\n      // 60 seconds timeout\n      signal: AbortSignal.timeout ? AbortSignal.timeout(60000) : undefined,\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text().catch(() => \"\");\n      throw new Error(\n        `HTTP ${response.status} ${response.statusText} ${errorText}`,\n      );\n    }\n\n    const result = (await response.json()) as OpenRouterImageResponse;\n\n    const images: { url: string; filepath?: string }[] = [];\n    const savedPaths: string[] = [];\n\n    // Extract images from the response\n    if (result.choices?.[0]?.message?.images) {\n      for (const [index, image] of result.choices[0].message.images.entries()) {\n        const base64Url = image.image_url.url;\n\n        // Save image to disk\n        const filepath = await saveBase64Image(\n          base64Url,\n          runtime.agentId,\n          index,\n        );\n        if (filepath) {\n          // Return the actual file path for Discord/Telegram compatibility\n          logger.log(`[OpenRouter] Returning image with filepath: ${filepath}`);\n          images.push({\n            url: filepath, // Use actual file path\n          });\n          savedPaths.push(filepath);\n        } else if (!base64Url.startsWith(\"data:\")) {\n          // If not base64, return as is (might be a URL)\n          images.push({ url: base64Url });\n        } else {\n          // Failed to save base64 image\n          logger.warn(\n            `[OpenRouter] Failed to save image ${index + 1}, skipping`,\n          );\n        }\n      }\n    }\n\n    // Clean up images after a short delay if auto-cleanup is enabled\n    if (savedPaths.length > 0 && shouldAutoCleanupImages(runtime)) {\n      setTimeout(() => {\n        savedPaths.forEach((path) => {\n          deleteImage(path);\n        });\n      }, 30000); // Delete after 30 seconds\n    }\n\n    if (images.length === 0) {\n      throw new Error(\"No images generated in response\");\n    }\n\n    logger.log(`[OpenRouter] Generated ${images.length} image(s)`);\n    return images;\n  } catch (error: unknown) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error(`[OpenRouter] Error generating image: ${message}`);\n    return [];\n  }\n}\n",
    "import { logger, getGeneratedDir } from \"@elizaos/core\";\n\nfunction isBrowser(): boolean {\n  return typeof globalThis !== \"undefined\" && (globalThis as any).document;\n}\n\n// Restrict identifiers to a safe subset to prevent path traversal/FS escape\nfunction sanitizeId(id: string): string {\n  const src = (id ?? \"\").toString();\n  const normalized = src.normalize(\"NFKC\");\n  let safe = normalized.replace(/[^a-zA-Z0-9_-]/g, \"_\");\n  safe = safe.replace(/_+/g, \"_\");\n  safe = safe.slice(0, 64);\n  safe = safe.replace(/^_+|_+$/g, \"\");\n  return safe || \"agent\";\n}\n\n// Lightweight base64 decoder that avoids Node Buffer and works in browser/Node\nfunction base64ToBytes(base64: string): Uint8Array {\n  // Remove padding\n  const cleaned = base64.replace(/\\s+/g, \"\");\n  const chars =\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n  const lookup: number[] = new Array(256).fill(-1);\n  for (let i = 0; i < chars.length; i++) lookup[chars.charCodeAt(i)] = i;\n\n  const len = cleaned.length;\n  let pad = 0;\n  if (len >= 2 && cleaned[len - 1] === \"=\") pad++;\n  if (len >= 2 && cleaned[len - 2] === \"=\") pad++;\n  const outLen = ((len * 3) >> 2) - pad;\n  const out = new Uint8Array(outLen);\n\n  let o = 0;\n  for (let i = 0; i < len; i += 4) {\n    const c0 = lookup[cleaned.charCodeAt(i)];\n    const c1 = lookup[cleaned.charCodeAt(i + 1)];\n    const c2 = lookup[cleaned.charCodeAt(i + 2)];\n    const c3 = lookup[cleaned.charCodeAt(i + 3)];\n    const n = (c0 << 18) | (c1 << 12) | ((c2 & 63) << 6) | (c3 & 63);\n    if (o < outLen) out[o++] = (n >> 16) & 255;\n    if (o < outLen) out[o++] = (n >> 8) & 255;\n    if (o < outLen) out[o++] = n & 255;\n  }\n  return out;\n}\n\n/**\n * Save base64 image to disk and return the file path\n */\nexport async function saveBase64Image(\n  base64Url: string,\n  agentId: string,\n  index: number = 0,\n): Promise<string | null> {\n  if (isBrowser()) {\n    return null;\n  }\n  // Extract base64 data and extension with MIME type validation\n  const m = base64Url.match(\n    /^data:(image\\/[a-zA-Z0-9.+-]+);base64,([A-Za-z0-9+/=]+)$/,\n  );\n  if (!m) return null;\n\n  const mime = m[1];\n  const base64Data = m[2];\n\n  // Whitelist of allowed MIME types mapped to extensions\n  const extMap: Record<string, string> = {\n    \"image/png\": \"png\",\n    \"image/jpeg\": \"jpg\",\n    \"image/jpg\": \"jpg\",\n    \"image/webp\": \"webp\",\n    \"image/gif\": \"gif\",\n    \"image/bmp\": \"bmp\",\n    \"image/tiff\": \"tiff\",\n  };\n\n  const extension = extMap[mime];\n  if (!extension) return null;\n\n  // Use ElizaOS convention: .eliza/data/generated/{agentId}/\n  const { join } = await import(\"node:path\");\n  const safeAgentId = sanitizeId(agentId);\n  const baseDir = join(getGeneratedDir(), safeAgentId);\n\n  // Create directory if it doesn't exist\n  const { existsSync } = await import(\"node:fs\");\n  if (!existsSync(baseDir)) {\n    const { mkdir } = await import(\"node:fs/promises\");\n    await mkdir(baseDir, { recursive: true });\n  }\n\n  // Generate filename with timestamp\n  const timestamp = Date.now();\n  const filename = `image_${timestamp}_${index}.${extension}`;\n  const filepath = join(baseDir, filename);\n\n  // Save image to disk\n  const buffer = base64ToBytes(base64Data);\n  const { writeFile } = await import(\"node:fs/promises\");\n  await writeFile(filepath, buffer);\n\n  logger.info(`[OpenRouter] Saved generated image to ${filepath}`);\n\n  // Return only the file path for Discord/Telegram to read\n  return filepath;\n}\n\n/**\n * Delete a specific image file\n */\nexport function deleteImage(filepath: string): void {\n  if (isBrowser()) {\n    return;\n  }\n  try {\n    (async () => {\n      const { existsSync, unlinkSync } = await import(\"node:fs\");\n      if (existsSync(filepath)) {\n        unlinkSync(filepath);\n        logger.debug(`[OpenRouter] Deleted image: ${filepath}`);\n      }\n    })().catch((error) => {\n      logger.warn(\n        `[OpenRouter] Failed to delete image ${filepath}:`,\n        String(error),\n      );\n    });\n  } catch (error) {\n    logger.warn(\n      `[OpenRouter] Failed to delete image ${filepath}:`,\n      String(error),\n    );\n  }\n}\n",
    "import type { IAgentRuntime, TextEmbeddingParams } from '@elizaos/core';\nimport { logger, ModelType, VECTOR_DIMS } from '@elizaos/core';\nimport { getSetting, getBaseURL, getApiKey, getEmbeddingModel } from '../utils/config';\nimport { emitModelUsageEvent } from '../utils/events';\n\n/**\n * TEXT_EMBEDDING model handler for OpenRouter\n */\nexport async function handleTextEmbedding(\n  runtime: IAgentRuntime,\n  params: TextEmbeddingParams | string | null\n): Promise<number[]> {\n  const embeddingModelName = getEmbeddingModel(runtime);\n  const embeddingDimension = Number.parseInt(\n    getSetting(runtime, 'OPENROUTER_EMBEDDING_DIMENSIONS') ??\n      getSetting(runtime, 'EMBEDDING_DIMENSIONS') ??\n      '1536',\n    10\n  ) as (typeof VECTOR_DIMS)[keyof typeof VECTOR_DIMS];\n\n  if (!Object.values(VECTOR_DIMS).includes(embeddingDimension)) {\n    const errorMsg = `Invalid embedding dimension: ${embeddingDimension}. Must be one of: ${Object.values(VECTOR_DIMS).join(', ')}`;\n    logger.error(errorMsg);\n    throw new Error(errorMsg);\n  }\n\n  if (params === null) {\n    logger.debug('Creating test embedding for initialization');\n    const testVector = Array(embeddingDimension).fill(0);\n    testVector[0] = 0.1;\n    return testVector;\n  }\n\n  let text: string;\n  if (typeof params === 'string') {\n    text = params;\n  } else if (typeof params === 'object' && params.text) {\n    text = params.text;\n  } else {\n    const errorMsg = 'Invalid input format for embedding';\n    logger.warn(errorMsg);\n    const fallbackVector = Array(embeddingDimension).fill(0);\n    fallbackVector[0] = 0.2;\n    return fallbackVector;\n  }\n\n  if (!text.trim()) {\n    const errorMsg = 'Empty text for embedding';\n    logger.warn(errorMsg);\n    const fallbackVector = Array(embeddingDimension).fill(0);\n    fallbackVector[0] = 0.3;\n    return fallbackVector;\n  }\n\n  const apiKey = getApiKey(runtime);\n  if (!apiKey) {\n    const errorMsg = 'OPENROUTER_API_KEY is not set';\n    logger.error(errorMsg);\n    throw new Error(errorMsg);\n  }\n\n  const baseURL = getBaseURL(runtime);\n\n  try {\n    const response = await fetch(`${baseURL}/embeddings`, {\n      method: 'POST',\n      headers: {\n        Authorization: `Bearer ${apiKey}`,\n        'Content-Type': 'application/json',\n        'HTTP-Referer': getSetting(runtime, 'OPENROUTER_HTTP_REFERER') || '',\n        'X-Title': getSetting(runtime, 'OPENROUTER_X_TITLE') || 'ElizaOS',\n      },\n      body: JSON.stringify({\n        model: embeddingModelName,\n        input: text,\n      }),\n    });\n\n    if (!response.ok) {\n      logger.error(`OpenRouter API error: ${response.status} - ${response.statusText}`);\n      throw new Error(`OpenRouter API error: ${response.status} - ${response.statusText}`);\n    }\n\n    const data = (await response.json()) as {\n      data: [{ embedding: number[] }];\n      usage?: { prompt_tokens: number; total_tokens: number };\n    };\n\n    if (!data?.data?.[0]?.embedding) {\n      logger.error('API returned invalid structure');\n      throw new Error('API returned invalid structure');\n    }\n\n    const embedding = data.data[0].embedding;\n\n    if (!Array.isArray(embedding) || embedding.length !== embeddingDimension) {\n      const errorMsg = `Embedding length ${embedding?.length ?? 0} does not match configured dimension ${embeddingDimension}`;\n      logger.error(errorMsg);\n      const fallbackVector = Array(embeddingDimension).fill(0);\n      fallbackVector[0] = 0.4;\n      return fallbackVector;\n    }\n\n    if (data.usage) {\n      const usage = {\n        inputTokens: data.usage.prompt_tokens,\n        outputTokens: 0,\n        totalTokens: data.usage.total_tokens,\n      };\n\n      emitModelUsageEvent(runtime, ModelType.TEXT_EMBEDDING, text, usage);\n    }\n\n    logger.log(`Got valid embedding with length ${embedding.length}`);\n    return embedding;\n  } catch (error: unknown) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error(`Error generating embedding: ${message}`);\n    throw error instanceof Error ? error : new Error(message);\n  }\n}\n"
  ],
  "mappings": "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",
  "debugId": "58E9583DC191044464756E2164756E21",
  "names": []
}