import{Q as t,T as e,aG as a,_ as n,g as i,s as r,a as l,b as s,t as o,q as c,l as p,c as u,F as d,K as h,a4 as f,e as g,z as m,H as x}from"./chunk-DtLV2ZA1.js";import{p as y}from"./chunk-B79bb235.js";import{p as w}from"./chunk-Bh5OI26A.js";import{d as S}from"./chunk-aL54STwV.js";import{o as v}from"./chunk-Ds8E_vkt.js";import"../assets/main-W9CNpUw-.js";import"./chunk-DyUEqYfx.js";import"./chunk-CZZOyyuL.js";import"./chunk-ByoYm48K.js";import"./chunk-Bb9WQsmb.js";import"./chunk-DepHno-n.js";import"./chunk-DYKbTpgs.js";import"./chunk-C0SZ43gy.js";function k(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function $(t){return t}var b=x.pie,A={sections:new Map,showData:!1},T=A.sections,D=A.showData,C=structuredClone(b),j={getConfig:n(()=>structuredClone(C),"getConfig"),clear:n(()=>{T=new Map,D=A.showData,m()},"clear"),setDiagramTitle:c,getDiagramTitle:o,setAccTitle:s,getAccTitle:l,setAccDescription:r,getAccDescription:i,addSection:n(({label:t,value:e})=>{if(e<0)throw new Error(`"${t}" has invalid value: ${e}. Negative values are not allowed in pie charts. All slice values must be >= 0.`);T.has(t)||(T.set(t,e),p.debug(`added new section: ${t}, with value: ${e}`))},"addSection"),getSections:n(()=>T,"getSections"),setShowData:n(t=>{D=t},"setShowData"),getShowData:n(()=>D,"getShowData")},M=n((t,e)=>{y(t,e),e.setShowData(t.showData),t.sections.map(e.addSection)},"populateDb"),z={parse:n(async t=>{const e=await w("pie",t);p.debug(e),M(e,j)},"parse")},O=n(t=>`\n  .pieCircle{\n    stroke: ${t.pieStrokeColor};\n    stroke-width : ${t.pieStrokeWidth};\n    opacity : ${t.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${t.pieOuterStrokeColor};\n    stroke-width: ${t.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${t.pieTitleTextSize};\n    fill: ${t.pieTitleTextColor};\n    font-family: ${t.fontFamily};\n  }\n  .slice {\n    font-family: ${t.fontFamily};\n    fill: ${t.pieSectionTextColor};\n    font-size:${t.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${t.pieLegendTextColor};\n    font-family: ${t.fontFamily};\n    font-size: ${t.pieLegendTextSize};\n  }\n`,"getStyles"),F=n(n=>{const i=[...n.values()].reduce((t,e)=>t+e,0),r=[...n.entries()].map(([t,e])=>({label:t,value:e})).filter(t=>t.value/i*100>=1).sort((t,e)=>e.value-t.value),l=function(){var n=$,i=k,r=null,l=t(0),s=t(e),o=t(0);function c(t){var c,p,u,d,h,f=(t=a(t)).length,g=0,m=new Array(f),x=new Array(f),y=+l.apply(this,arguments),w=Math.min(e,Math.max(-e,s.apply(this,arguments)-y)),S=Math.min(Math.abs(w)/f,o.apply(this,arguments)),v=S*(w<0?-1:1);for(c=0;c<f;++c)(h=x[m[c]=c]=+n(t[c],c,t))>0&&(g+=h);for(null!=i?m.sort(function(t,e){return i(x[t],x[e])}):null!=r&&m.sort(function(e,a){return r(t[e],t[a])}),c=0,u=g?(w-f*v)/g:0;c<f;++c,y=d)p=m[c],d=y+((h=x[p])>0?h*u:0)+v,x[p]={data:t[p],index:c,value:h,startAngle:y,endAngle:d,padAngle:S};return x}return c.value=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),c):n},c.sortValues=function(t){return arguments.length?(i=t,r=null,c):i},c.sort=function(t){return arguments.length?(r=t,i=null,c):r},c.startAngle=function(e){return arguments.length?(l="function"==typeof e?e:t(+e),c):l},c.endAngle=function(e){return arguments.length?(s="function"==typeof e?e:t(+e),c):s},c.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),c):o},c}().value(t=>t.value);return l(r)},"createPieArcs"),R={parser:z,db:j,renderer:{draw:n((t,e,a,n)=>{p.debug("rendering pie chart\n"+t);const i=n.db,r=u(),l=d(i.getConfig(),r.pie),s=18,o=450,c=o,m=h(e),x=m.append("g");x.attr("transform","translate(225,225)");const{themeVariables:y}=r;let[w]=f(y.pieOuterStrokeWidth);w??=2;const k=l.textPosition,$=Math.min(c,o)/2-40,b=S().innerRadius(0).outerRadius($),A=S().innerRadius($*k).outerRadius($*k);x.append("circle").attr("cx",0).attr("cy",0).attr("r",$+w/2).attr("class","pieOuterCircle");const T=i.getSections(),D=F(T),C=[y.pie1,y.pie2,y.pie3,y.pie4,y.pie5,y.pie6,y.pie7,y.pie8,y.pie9,y.pie10,y.pie11,y.pie12];let j=0;T.forEach(t=>{j+=t});const M=D.filter(t=>"0"!==(t.data.value/j*100).toFixed(0)),z=v(C);x.selectAll("mySlices").data(M).enter().append("path").attr("d",b).attr("fill",t=>z(t.data.label)).attr("class","pieCircle"),x.selectAll("mySlices").data(M).enter().append("text").text(t=>(t.data.value/j*100).toFixed(0)+"%").attr("transform",t=>"translate("+A.centroid(t)+")").style("text-anchor","middle").attr("class","slice"),x.append("text").text(i.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const O=[...T.entries()].map(([t,e])=>({label:t,value:e})),R=x.selectAll(".legend").data(O).enter().append("g").attr("class","legend").attr("transform",(t,e)=>"translate(216,"+(22*e-22*O.length/2)+")");R.append("rect").attr("width",s).attr("height",s).style("fill",t=>z(t.label)).style("stroke",t=>z(t.label)),R.append("text").attr("x",22).attr("y",14).text(t=>i.getShowData()?`${t.label} [${t.value}]`:t.label);const W=512+Math.max(...R.selectAll("text").nodes().map(t=>t?.getBoundingClientRect().width??0));m.attr("viewBox",`0 0 ${W} 450`),g(m,o,W,l.useMaxWidth)},"draw")},styles:O};export{R as diagram};
//# sourceMappingURL=pieDiagram-ADFJNKIX.mjs-CETqYwbc.js.map
